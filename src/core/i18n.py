
TRANSLATIONS = {
    # Login
    "welcome_back": {"ar": "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ", "en": "WELCOME BACK"},
    "system_title": {"ar": "Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯", "en": "Contract Monitor System"},
    "username": {"ar": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "en": "Username"},
    "password": {"ar": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "en": "Password"},
    "login_btn": {"ar": "Ø¯Ø®ÙˆÙ„", "en": "LOGIN"},
    "invalid_creds": {"ar": "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©", "en": "Invalid credentials"},
    "image_not_found": {"ar": "Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©", "en": "Image not found"},
    
    # Sidebar
    "dashboard": {"ar": "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", "en": "Dashboard"},
    "smart_search": {"ar": "Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ", "en": "Smart Search"},
    "cv_translator": {"ar": "ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV Translator"},
    "permissions": {"ar": "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª", "en": "Permissions"},
    "logout": {"ar": "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬", "en": "Logout"},
    "debug": {"ar": "ÙØ­Øµ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡", "en": "Debug"},
    "test_db": {"ar": "ÙØ­Øµ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "en": "Test DB"},
    "programmer": {"ar": "Programmed by Alsaeed Alwazzan", "en": "Programmed by Alsaeed Alwazzan"},

    # Dashboard
    "contract_dashboard": {"ar": "Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯", "en": "Contract Dashboard"},
    "no_data": {"ar": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª", "en": "No data found"},
    "urgent_7_days": {"ar": "Ø¹Ø§Ø¬Ù„ (7 Ø£ÙŠØ§Ù…)", "en": "Urgent (7 Days)"},
    "expired": {"ar": "Ù…Ù†ØªÙ‡ÙŠ", "en": "Expired"},
    "active": {"ar": "Ø³Ø§Ø±ÙŠ", "en": "Active"},
    "urgent": {"ar": "Ø¹Ø§Ø¬Ù„", "en": "Urgent"},
    "cv_download": {"ar": "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV Download"},
    "download_pdf": {"ar": "ØªØ­Ù…ÙŠÙ„ PDF", "en": "Download PDF"},
    "tabs_urgent": {"ar": "ğŸ”´ Ø¹Ø§Ø¬Ù„", "en": "ğŸ”´ Urgent"},
    "tabs_expired": {"ar": "âš« Ù…Ù†ØªÙ‡ÙŠ", "en": "âš« Expired"},
    "tabs_active": {"ar": "ğŸŸ¢ Ø³Ø§Ø±ÙŠ", "en": "ğŸŸ¢ Active"},

    # Search
    "smart_search_title": {"ar": "Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ (AI)", "en": "Smart AI Search"},
    "search_placeholder": {"ar": "Ù…Ø«Ø§Ù„: Ø³Ø§Ø¦Ù‚ ÙÙ„Ø¨ÙŠÙ†ÙŠØŒ +96650...", "en": "e.g. Filipino Driver, +96650..."},
    "search_btn": {"ar": "Ø¨Ø­Ø«", "en": "Search"},
    "no_results": {"ar": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬", "en": "No results"},

    # Translator
    "translator_title": {"ar": "ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV Translator"},
    "translator_desc": {"ar": "Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© (PDF) Ù„ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ ÙˆØªØ±Ø¬Ù…ØªÙ‡ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©.", "en": "Upload a CV (PDF) to translate it from English to Arabic automatically."},
    "upload_cv": {"ar": "Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù", "en": "Upload CV"},
    "translate_now": {"ar": "ØªØ±Ø¬Ù… Ø§Ù„Ø¢Ù†", "en": "Translate Now"},
    "extracting": {"ar": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø©...", "en": "Extracting & Translating..."},
    "original": {"ar": "Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ (English)", "en": "Original (English)"},
    "translated": {"ar": "Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ±Ø¬Ù… (Ø¹Ø±Ø¨ÙŠ)", "en": "Translated (Arabic)"},
    "download_trans": {"ar": "ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø©", "en": "Download Translation"},

    # Permissions
    "permissions_title": {"ar": "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª", "en": "Permissions Management"},
    "add_user": {"ar": "Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯", "en": "Add New User"},
    "role": {"ar": "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©", "en": "Role"},
    "add_btn": {"ar": "Ø¥Ø¶Ø§ÙØ©", "en": "Add User"},
    "users_list": {"ar": "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†", "en": "Users List"},
    "edit_user": {"ar": "ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…", "en": "Edit User"},
    "select_user": {"ar": "Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "en": "Select User"},
    "new_password": {"ar": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)", "en": "New Password (Optional)"},
    "update_btn": {"ar": "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "en": "Update User"},
    "update_success": {"ar": "ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­", "en": "Updated successfully"},
    "user_exists": {"ar": "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹", "en": "User already exists"},
    "user_added": {"ar": "ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­", "en": "User added successfully"},
    "image_error": {"ar": "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©", "en": "Image Error"},
    
    # Common
    "error": {"ar": "Ø®Ø·Ø£", "en": "Error"},
    "success": {"ar": "Ù†Ø¬Ø§Ø­", "en": "Success"},

    # Column Headers
    "columns": {
        "Name": {"ar": "Ø§Ù„Ø§Ø³Ù…", "en": "Name"},
        "Passport Number": {"ar": "Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ø²", "en": "Passport Number"},
        "Nationality": {"ar": "Ø§Ù„Ø¬Ù†Ø³ÙŠØ©", "en": "Nationality"},
        "Job": {"ar": "Ø§Ù„Ù…Ù‡Ù†Ø©", "en": "Job"},
        "Sponsor Name": {"ar": "Ø§Ø³Ù… Ø§Ù„ÙƒÙÙŠÙ„", "en": "Sponsor Name"},
        "Mobile": {"ar": "Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„", "en": "Mobile"},
        "Contract Duration": {"ar": "Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚Ø¯", "en": "Contract Duration"},
        "Contract End Date": {"ar": "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯", "en": "Contract End Date"},
        "Status": {"ar": "Ø§Ù„Ø­Ø§Ù„Ø©", "en": "Status"},
        "CV": {"ar": "Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV"},
        "Religion": {"ar": "Ø§Ù„Ø¯ÙŠØ§Ù†Ø©", "en": "Religion"},
        "Birth Date": {"ar": "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯", "en": "Birth Date"},
        "Arrival Date": {"ar": "ØªØ§Ø±ÙŠØ® Ø§Ù„ÙˆØµÙˆÙ„", "en": "Arrival Date"},
        "User": {"ar": "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "en": "User"},
        "Role": {"ar": "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©", "en": "Role"},
        
        # New Columns (User Feedback)
        "Gender": {"ar": "Ø§Ù„Ø¬Ù†Ø³", "en": "Gender"},
        "Phone Number": {"ar": "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", "en": "Phone Number"},
        "Is your contract expired": {"ar": "Ù‡Ù„ Ø§Ù„Ø¹Ù‚Ø¯ Ù…Ù†ØªÙ‡ÙŠØŸ", "en": "Is your contract expired?"},
        "When is your contract end date?": {"ar": "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯", "en": "When is your contract end date?"},
        "your Age:": {"ar": "Ø§Ù„Ø¹Ù…Ø±", "en": "your Age:"},
        "Are you working now?": {"ar": "Ù‡Ù„ ØªØ¹Ù…Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹ØŸ", "en": "Are you working now?"},
        "Do you have any financial obligations towards your previous employer?": {"ar": "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ù…Ø§Ù„ÙŠØ© Ø³Ø§Ø¨Ù‚Ø©ØŸ", "en": "Do you have any financial obligations..."},
        "Timestamp": {"ar": "ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„", "en": "Timestamp"},
        "notes": {"ar": "Ù…Ù„Ø§Ø­Ø¸Ø§Øª", "en": "Notes"},
        
        # Round 2 Feedback
        "Are you in Saudi Arabia now": {"ar": "Ù‡Ù„ Ø£Ù†Øª ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø§Ù„Ø¢Ù†ØŸ", "en": "Are you in Saudi Arabia now"},
        "If you are Huroob, how many days or months have you been Huroob?": {"ar": "Ù…Ø¯Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ (Ø¥Ù† ÙˆØ¬Ø¯)", "en": "If you are Huroob..."},
        "Will your employer accept to transfer your sponsorship": {"ar": "Ù‡Ù„ ÙŠÙ‚Ø¨Ù„ ÙƒÙÙŠÙ„Ùƒ Ø§Ù„Ù†Ù‚Ù„ØŸ", "en": "Will your employer accept..."},
    }
}

def t(key, lang="ar"):
    return TRANSLATIONS.get(key, {}).get(lang, key)

def t_col(col_name, lang="ar"):
    """Translates a column name with fuzzy matching (ignores case/spaces)."""
    if lang == 'en': return col_name
    
    col_str = str(col_name).strip()
    
    # 1. Try Exact Match
    res = TRANSLATIONS.get("columns", {}).get(col_str, {}).get("ar")
    if res: return res
    
    # 2. Try Case-Insensitive Match
    cols_map = {k.strip().lower(): v.get("ar") for k, v in TRANSLATIONS.get("columns", {}).items()}
    res_fuzzy = cols_map.get(col_str.lower())
    if res_fuzzy: return res_fuzzy
    
    # 3. Fallback for specific partials (Robust Matching)
    col_lower = col_str.lower()
    if "financial obligations" in col_lower: return "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ù…Ø§Ù„ÙŠØ©ØŸ"
    if "contract end" in col_lower: return "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯"
    if "mobile" in col_lower: return "Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„"
    if "phone" in col_lower: return "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
    if "huroob" in col_lower: return "Ù…Ø¯Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ (Ø¥Ù† ÙˆØ¬Ø¯)"
    if "saudi arabia" in col_lower and "now" in col_lower: return "Ù‡Ù„ Ø£Ù†Øª ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø§Ù„Ø¢Ù†ØŸ"
    if "transfer your sponsorship" in col_lower: return "Ù‡Ù„ ÙŠÙ‚Ø¨Ù„ ÙƒÙÙŠÙ„Ùƒ Ø§Ù„Ù†Ù‚Ù„ØŸ"
    
    return col_name
