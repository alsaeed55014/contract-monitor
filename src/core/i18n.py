
TRANSLATIONS = {
    # Login
    "welcome_back": {"ar": "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ", "en": "WELCOME BACK"},
    "system_title": {"ar": "Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯", "en": "Contract Monitor System"},
    "username": {"ar": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "en": "Username"},
    "password": {"ar": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "en": "Password"},
    "login_btn": {"ar": "Ø¯Ø®ÙˆÙ„", "en": "LOGIN"},
    "invalid_creds": {"ar": "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©", "en": "Invalid credentials"},
    "image_not_found": {"ar": "Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©", "en": "Image not found"},
    
    # Sidebar
    "dashboard": {"ar": "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", "en": "Dashboard"},
    "smart_search": {"ar": "Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ", "en": "Smart Search"},
    "cv_translator": {"ar": "ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV Translator"},
    "permissions": {"ar": "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª", "en": "Permissions"},
    "logout": {"ar": "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬", "en": "Logout"},
    "debug": {"ar": "ÙØ­Øµ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡", "en": "Debug"},
    "test_db": {"ar": "ÙØ­Øµ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "en": "Test DB"},
    "programmer": {"ar": "Programmed by Alsaeed Alwazzan", "en": "Programmed by Alsaeed Alwazzan"},

    # Dashboard
    "contract_dashboard": {"ar": "Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯", "en": "Contract Dashboard"},
    "no_data": {"ar": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª", "en": "No data found"},
    "urgent_7_days": {"ar": "Ø¹Ø§Ø¬Ù„ (7 Ø£ÙŠØ§Ù…)", "en": "Urgent (7 Days)"},
    "expired": {"ar": "Ù…Ù†ØªÙ‡ÙŠ", "en": "Expired"},
    "active": {"ar": "Ø³Ø§Ø±ÙŠ", "en": "Active"},
    "urgent": {"ar": "Ø¹Ø§Ø¬Ù„", "en": "Urgent"},
    "cv_download": {"ar": "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV Download"},
    "download_pdf": {"ar": "ØªØ­Ù…ÙŠÙ„ PDF", "en": "Download PDF"},
    "tabs_urgent": {"ar": "ğŸ”´ Ø¹Ø§Ø¬Ù„", "en": "ğŸ”´ Urgent"},
    "tabs_expired": {"ar": "âš« Ù…Ù†ØªÙ‡ÙŠ", "en": "âš« Expired"},
    "tabs_active": {"ar": "ğŸŸ¢ Ø³Ø§Ø±ÙŠ", "en": "ğŸŸ¢ Active"},

    # Search
    "smart_search_title": {"ar": "Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ (AI)", "en": "Smart AI Search"},
    "search_placeholder": {"ar": "Ù…Ø«Ø§Ù„: Ø³Ø§Ø¦Ù‚ ÙÙ„Ø¨ÙŠÙ†ÙŠØŒ +96650...", "en": "e.g. Filipino Driver, +96650..."},
    "search_btn": {"ar": "Ø¨Ø­Ø«", "en": "Search"},
    "no_results": {"ar": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬", "en": "No results"},

    # Translator
    "translator_title": {"ar": "ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "CV Translator"},
    "translator_desc": {"ar": "Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© (PDF) Ù„ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ ÙˆØªØ±Ø¬Ù…ØªÙ‡ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©.", "en": "Upload a CV (PDF) to translate it from English to Arabic automatically."},
    "upload_cv": {"ar": "Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù", "en": "Upload CV"},
    "translate_now": {"ar": "ØªØ±Ø¬Ù… Ø§Ù„Ø¢Ù†", "en": "Translate Now"},
    "extracting": {"ar": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø©...", "en": "Extracting & Translating..."},
    "original": {"ar": "Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ (English)", "en": "Original (English)"},
    "translated": {"ar": "Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ±Ø¬Ù… (Ø¹Ø±Ø¨ÙŠ)", "en": "Translated (Arabic)"},
    "download_trans": {"ar": "ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø©", "en": "Download Translation"},

    # Permissions
    "permissions_title": {"ar": "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª", "en": "Permissions Management"},
    "add_user": {"ar": "Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯", "en": "Add New User"},
    "role": {"ar": "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©", "en": "Role"},
    "add_btn": {"ar": "Ø¥Ø¶Ø§ÙØ©", "en": "Add User"},
    "users_list": {"ar": "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†", "en": "Users List"},
    "edit_user": {"ar": "ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…", "en": "Edit User"},
    "select_user": {"ar": "Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "en": "Select User"},
    "new_password": {"ar": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)", "en": "New Password (Optional)"},
    "update_btn": {"ar": "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "en": "Update User"},
    "update_success": {"ar": "ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­", "en": "Updated successfully"},
    "user_exists": {"ar": "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹", "en": "User already exists"},
    "user_added": {"ar": "ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­", "en": "User added successfully"},
    "image_error": {"ar": "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©", "en": "Image Error"},
    
    # Common
    "error": {"ar": "Ø®Ø·Ø£", "en": "Error"},
    "success": {"ar": "Ù†Ø¬Ø§Ø­", "en": "Success"},


    # Column Headers (Exact Matches from User Data)
    "columns": {
        "Ø·Ø§Ø¨Ø¹ Ø²Ù…Ù†ÙŠ": {"ar": "ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„", "en": "Timestamp"},
        "Full Name:": {"ar": "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„", "en": "Full Name"},
        "Nationality": {"ar": "Ø§Ù„Ø¬Ù†Ø³ÙŠØ©", "en": "Nationality"},
        "Gender": {"ar": "Ø§Ù„Ø¬Ù†Ø³", "en": "Gender"},
        "Phone Number": {"ar": "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ", "en": "Phone Number"},
        "Is your contract expired": {"ar": "Ù‡Ù„ Ø§Ù„Ø¹Ù‚Ø¯ Ù…Ù†ØªÙ‡ÙŠØŸ", "en": "Is your contract expired?"},
        "When is your contract end date?": {"ar": "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯", "en": "Contract End Date"},
        "your Age:": {"ar": "Ø§Ù„Ø¹Ù…Ø±", "en": "Age"},
        "Are you working now?": {"ar": "Ù‡Ù„ ØªØ¹Ù…Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹ØŸ", "en": "Are you working now?"},
        "Do you have any financial obligations towards your previous sponsor": {"ar": "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ù…Ø§Ù„ÙŠØ© Ù„Ù„ÙƒÙÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚ØŸ", "en": "Financial Obligations"},
        "Do you have to report Huroob": {"ar": "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø¨Ù„Ø§Øº Ù‡Ø±ÙˆØ¨ØŸ", "en": "Huroob Report"},
        "If you are Huroob, how many days or months have you been Huroob?": {"ar": "Ù…Ø¯Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨", "en": "Huroob Duration"},
        "Will your employer accept to transfer your sponsorship": {"ar": "Ù‡Ù„ ÙŠÙ‚Ø¨Ù„ Ø§Ù„ÙƒÙÙŠÙ„ Ø§Ù„Ù†Ù‚Ù„ØŸ", "en": "Sponsorship Transfer"},
        "Are you in Saudi Arabia now": {"ar": "Ù‡Ù„ Ø£Ù†Øª ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŸ", "en": "In KSA?"},
        "Which city in Saudi Arabia are you in": {"ar": "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", "en": "City"},
        "What is the name of the area where you live?": {"ar": "Ø§Ù„Ù…Ù†Ø·Ù‚Ø©/Ø§Ù„Ø­ÙŠ", "en": "Area"},
        "Do you speak Arabic": {"ar": "Ù‡Ù„ ØªØªØ­Ø¯Ø« Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŸ", "en": "Speaks Arabic"},
        "Which job are you looking for": {"ar": "Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©", "en": "Job Requested"},
        "How much experience do you have in this field?": {"ar": "Ø§Ù„Ø®Ø¨Ø±Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¬Ø§Ù„", "en": "Experience"},
        "What other jobs can you do": {"ar": "Ù…Ù‡Ø§Ø±Ø§Øª Ø£Ø®Ø±Ù‰", "en": "Other Skills"},
        "How much experience do you have in this field?_1": {"ar": "Ø§Ù„Ø®Ø¨Ø±Ø© (Ø£Ø®Ø±Ù‰)", "en": "Experience (Other)"},
        "Do you have Card Baladiya": {"ar": "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ ÙƒØ±Øª Ø¨Ù„Ø¯ÙŠØ©ØŸ", "en": "Baladiya Card"},
        "Is the Card Baladiya  valid?": {"ar": "Ù‡Ù„ Ø§Ù„ÙƒØ±Øª Ø³Ø§Ø±ÙŠØŸ", "en": "Card Valid?"},
        "how many months Card Baladiya valid": {"ar": "Ù…Ø¯Ø© ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙƒØ±Øª (Ø£Ø´Ù‡Ø±)", "en": "Card Validity (Months)"},
        "how many months Card Baladiya expires": {"ar": "Ù…ØªÙ‰ ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„ÙƒØ±Øª (Ø£Ø´Ù‡Ø±)", "en": "Card Expiry (Months)"},
        "Can you work outside your city": {"ar": "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ù…Ù„ Ø®Ø§Ø±Ø¬ Ù…Ø¯ÙŠÙ†ØªÙƒØŸ", "en": "Work Outside City"},
        "Are you ready to work immediately?": {"ar": "Ù‡Ù„ Ø£Ù†Øª Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„ ÙÙˆØ±Ø§Ù‹ØŸ", "en": "Ready Immediately"},
        "Are you married and do your children reside with you in Saudi Arabia?": {"ar": "Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© ÙˆÙ‡Ù„ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ù…Ø¹ÙƒØŸ", "en": "Marital Status & Family"},
        "Iqama ID number": {"ar": "Ø±Ù‚Ù… Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "en": "Iqama ID"},
        "What is the occupation listed on your Iqama": {"ar": "Ø§Ù„Ù…Ù‡Ù†Ø© ÙÙŠ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "en": "Iqama Profession"},
        "your Iqama Valid": {"ar": "Ù‡Ù„ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© Ø³Ø§Ø±ÙŠØ©ØŸ", "en": "Iqama Valid"},
        "If the Iqama is valid, how many months are left?": {"ar": "Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© ÙÙŠ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "en": "Iqama Remaining"},
        "If the Iqama expired how many months ago?": {"ar": "Ù…Ø¯Ø© Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "en": "Iqama Expired Since"},
        "How many times did you transfer your sponsorship": {"ar": "Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ù†Ù‚Ù„ Ø§Ù„ÙƒÙØ§Ù„Ø©", "en": "Transfer Count"},
        "Download CV": {"ar": "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©", "en": "Download CV"},
        "How did you know us?": {"ar": "ÙƒÙŠÙ Ø¹Ø±ÙØª Ø¹Ù†Ø§ØŸ", "en": "How did you know us?"}
    }
}

def t(key, lang="ar"):
    return TRANSLATIONS.get(key, {}).get(lang, key)

def t_col(col_name, lang="ar"):
    """Translates a column name using exact lookups from the `columns` dictionary."""
    if lang == 'en': return col_name
    
    col_str = str(col_name).strip()
    
    # 1. Try Exact Match
    res = TRANSLATIONS.get("columns", {}).get(col_str, {}).get("ar")
    if res: return res
    
    # 2. Try Case-Insensitive Match
    cols_map = {k.strip().lower(): v.get("ar") for k, v in TRANSLATIONS.get("columns", {}).items()}
    res_fuzzy = cols_map.get(col_str.lower())
    if res_fuzzy: return res_fuzzy
    
    # 3. Enhanced Partial Matches (Fallback)
    col_lower = col_str.lower()
    
    # Prioritize specific partials causing issues
    if "financial obligations" in col_lower: return "Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©"
    if "card baladiya" in col_lower: return "ÙƒØ±Øª Ø§Ù„Ø¨Ù„Ø¯ÙŠØ©"
    if "iqama" in col_lower: return "Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©"
    if "experience" in col_lower: return "Ø§Ù„Ø®Ø¨Ø±Ø©"
    if "huroob" in col_lower: return "Ø§Ù„Ù‡Ø±ÙˆØ¨"
    if "contract end" in col_lower: return "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯"
    
    return col_name
